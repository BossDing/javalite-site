/**
 * jQuery Elixon TOC Plugin
 * Get a full version at http://www.webdevelopers.eu/jquery/toc
 */
(function(e){function i(t){var n=e.trim((t+"").replace(/[^a-z0-9]+/gi," ")).split(/ +/);var r=(n[0]||"").toLowerCase();for(var i=1;i<n.length;i++){r+=n[i].charAt(0).toUpperCase()+n[i].substr(1)}return r||"cname"}function s(t,n,r){var i=t.attr("href");var s=e(i);if(!s.length)return true;var o=s.offset().top-Math.min(n.offset,(e(window).height()-n.offset)/2);u(t.closest(".toc"),t,n);e("html, body").stop().animate({scrollTop:o},Math.abs(e(window).scrollTop()-o),"easeJTOC",function(){r();e("body").trigger("scroll")});return false}function o(t,n,r){var i=-1,s=e(window).height()-r.offset,o=e(window).scrollTop()+Math.min(r.offset,s/2)-5,a=o+s,f=e();n.each(function(){var t=e(this);var n=t.offset();if(n.top<=o&&n.top>i||n.top>=o&&n.top<a&&(i<o||i>n.top)){i=n.top;f=t}});var l=e('.tocLink[href="#'+f.attr("id")+'"]',t);u(t,l,r);return l}function u(t,n,r){if(n.is(".tocSelected")){return}e(".tocSelected",t).removeClass("tocSelected");n.addClass("tocSelected");if(!e(".toc",t).is(".nohiliteFeat")){r.templateDef.hilite.call(t.get(0),n,r)}if(typeof r.callback=="function"){r.callback.call(t.get(0),n)}}function a(t,n,r,i){var s;if(!t||!t.length)return;if(!n.length){e(".tocSub",t).addClass("noChildren");e(".tocLevel",t).remove();return}s=t.is(".tocSub")?t:e(".tocSub",t).not(e(".tocItem .tocSub, .tocItem.tocSub",t));if(s.length){s.addClass("hasChildren");s=e("<div></div>").appendTo(s)}else{s=e(".tocLevel",t);s.parent().addClass("hasChildren")}if(!s.length)return;var o=e(".tocItem .tocLevel",r).not(e(".tocItem .tocItem .tocLevel",r));if(!o.length){o=r}var u=f(n,o,i);if(u){s.replaceWith(u)}}function f(t,i,s){if(!t.length)return null;i.addClass("tocLevel");var o=i.clone(true,true);var u=e(".tocItem",o).not(e(".tocItem .tocItem",o));var f=n(t.first(),s.tocLevels);var l=[];var c=false;t.each(function(o,h){if(n(e(this),s.tocLevels)>f){l.push(this);return}if(!e(this).attr("id")){e(this).attr("id",r(e(this).text()))}a(c,e(l),i,s);l=[];c=u.clone(true,true);var p=(c.is(".tocLink")?c:e(".tocLink",c).not(e(".tocItem .tocLink",c))).not(e(".tocItem .tocLink",c));p.attr("href","#"+e(this).attr("id"));var d=c.is(".tocLabel")?c:e(".tocLabel",c).not(e(".tocItem .tocLabel",c));d.text(s.labeler.call(this,{position:o+1,label:d,levelElements:t,opts:s}));u.before(c)});a(c,e(l),i,s);u.remove();return o}var t=false;jQuery.easing.easeJTOC=function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n};var n=function(e,t){for(var n=0;n<t.length;n++){if(e.is(t[n]))return n+1}var r=e.get(0);return parseInt((r.localName||r.tagName||r.nodeName).replace(/[^1-6]/g,""))||1};var r=function(t){var n=i(t),r=1,s=n;while(e("#"+s).length){s=n+r++}return s};e.fn.toc=function(){var n=e.extend({},e.fn.toc.defaults);for(var r=0;r<arguments.length;r++){var i=arguments[r];switch(typeof i){case"number":n.offset=parseInt(i);break;case"function":n.labeler=i;break;case"string":var u=i.split(":");if(e.fn.toc.templates[u[0]]){n.template=u.shift();n.className+=" "+(u.length?u.join("Feat ")+"Feat":"");break}else if(e.isNumeric(i)){n.offset=parseInt(i);break};case"object":if(e.isArray(i)){n.tocLevels=i}else if(e.isPlainObject(i)){e.extend(n,i)}else{n.headers=e(i);if(!n.headers.length){console&&console.log&&(console.err||console.warn||console.log)("TOC: No headers selected! Invalid header selector: "+i);return}}}}n.templateDef=e.fn.toc.templates[n.template]||e.fn.toc.templates["default"];for(var a in e.fn.toc.templates["default"]){switch(typeof n.templateDef[a]){case"string":while(e.fn.toc.templates[n.templateDef[a]]){n.templateDef[a]=e.fn.toc.templates[n.templateDef[a]][a]}break;case"undefined":n.templateDef[a]=e.fn.toc.templates["default"][a];break}}if(!n.headers)n.headers=e(n.tocLevels.join(", "));this.each(function(){var r=f(n.headers,e(n.templateDef.layout),n);var i=e(this);e(".tocContainer",r).contents().unwrap();i.append(r.addClass("toc "+" "+n.className+" "+n.templateDef.className));n.templateDef.cleanup.call(r.get(0));e(".tocLink",i).on("click",function(){t=true;return s(e(this),n,function(){t=false})});var u=0;e(window).on("scroll",function(){if(!t&&!u){var r=e(this);u=setTimeout(function(){var e=o(i,n.headers,n);u=0},200)}});o(i,n.headers,n)});return this};e.fn.toc.defaults={headers:undefined,callback:undefined,labeler:function(t){return e(this).text()},template:"default",offset:8,tocLevels:["h1","h2","h3","h4","h5","h6"],className:"",templateDef:undefined};e.fn.toc.templates={"default":{className:"tocNumDec tmplDefault",layout:"<ol>"+'  <li class="tocItem tocSub">'+'    <a href="#" class="tocLabel tocLink">…</a>'+"  </li>"+"</ol>",hilite:function(t,n){e(".tocActive, .tocActiveParent",this).removeClass("tocActive tocActiveParent");t.addClass("tocActive").closest(".tocItem").addClass("tocActive").parentsUntil(".toc",".tocItem").addClass("tocActiveParent")},cleanup:function(){return}},modern:{className:"tmplDefault tmplModern"},elegant:{className:"tmplDefault tmplElegant"},simple:{className:"tmplSimple"},"bootstrap3.dropdown":{className:"tmplBSDropdown",layout:'<div class="dropdown">'+'  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">'+'    <li class="tocItem" role="presentation"><a role="menuitem" tabindex="-1" href="#" class="tocLabel tocLink">…</a></li>'+"  </ul>"+"</div>",hilite:function(t,n){e(".active",this).removeClass("active");t.closest("li").addClass("active");e.fn.toc.templates["default"].hilite.call(this,t,n)}},"bootstrap3.buttons":{className:"tmpl",layout:'<div class="tocContainer"><div class="btn-group tocItem">'+'    <button type="button" class="btn btn-default tocLabel tocLink">…</button>'+'    <div class="tocContainer tocLevel">'+'      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>'+'      <ul class="dropdown-menu" role="menu">'+'         <li class="tocItem"><a href="#" class="tocLabel tocLink">…</a></li>'+"      </ul>"+"    </div>"+"</div></div>",hilite:function(t,n){e(".active",this).removeClass("active");t.closest("li").addClass("active");t.closest(".btn-group").find("> button").addClass("active");e.fn.toc.templates["default"].hilite.call(this,t,n)}},"bootstrap3.pills":{className:"nav nav-pills",layout:'<ul><li class="tocItem"><a class="tocLink tocLabel" href="#">Home</a></li></ul>',hilite:"bootstrap3.dropdown"},"bootstrap3.pills.stacked":{className:"nav nav-pills nav-stacked",layout:"bootstrap3.pills",hilite:"bootstrap3.pills"},"bootstrap3.pills.justified":{className:"nav nav-pills nav-justified",layout:"bootstrap3.pills",hilite:"bootstrap3.pills"},"bootstrap3.pager":{className:"pager",layout:"bootstrap3.pills",hilite:"bootstrap3.pills"},"bootstrap3.list":{className:"list-group",layout:'<ul><li class="tocItem list-group-item tocLink tocLabel"></li></ul>',hilite:"bootstrap3.dropdown"},"bootstrap3.navbar":{className:"nav navbar-nav",hilite:function(t,n){e.fn.toc.templates["default"].hilite.call(this,t,n);e(".active",this).removeClass("active");t.closest(".toc").find(".tocActive, .tocActiveParent").addClass("active")},layout:'<ul class="nav navbar-nav">'+'  <li class="dropdown tocItem">'+'    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="tocLabel tocLink">Dropdown</span> <b class="caret"></b></a>'+'    <ul class="dropdown-menu tocLevel">'+'      <li class="tocItem"><a href="#" class="tocLink tocLabel">Action</a></li>'+"    </ul>"+"  </li>"+"</ul>",cleanup:function(){var t=e(this);e("> li:not(:has(ul))",t).each(function(){e(this).removeClass("dropdown").find("a").removeAttr("class").removeAttr("data-toggle").find(".caret").remove()})}}};e(function(){e("*[toctemplate], *[tocfroom]").each(function(){var t=e(this);t.toc(t.attr("toctemplate"),t.attr("tocfrom"),t.attr("tocoffset"))})});var l="W3-140415-042428";if(location.protocol.match(/^http/)&&!location.hostname.match(/^[0-9.]+$/)&&l.match(/^W3/)){var c=l.replace(/^W3-(..)(..)(..)-(..)(..)(..)$/,"20$1-$2-$3T$4:$5:$6Z");var h=new Date(c);if(h.getTime()&&h.getTime()+30*24*36e5<(new Date).getTime()){if(confirm("Would you like to obtain a full version of jQuery Elixon TOC?")){window.location="http://www.webdevelopers.eu/jquery/toc/buy?trial=expired"}}}})(jQuery);
